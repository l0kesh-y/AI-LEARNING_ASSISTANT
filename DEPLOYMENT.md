# Deployment Guide

This guide will help you deploy your AI Learning Assistant to Render (backend) and Netlify (frontend).

## Prerequisites

1. GitHub account with your code pushed to a repository
2. Render account (free tier available)
3. Netlify account (free tier available)
4. Groq API key

## Backend Deployment (Render)

### Step 1: Prepare Environment Variables

You'll need these environment variables in Render:

- `NODE_ENV=production`
- `MONGODB_URI` (will be auto-generated by Render's MongoDB)
- `JWT_SECRET` (generate a secure random string)
- `GROQ_API_KEY` (your Groq API key)
- `FRONTEND_URL` (will be your Netlify URL, e.g., https://your-app.netlify.app)

### Step 2: Deploy to Render

1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click "New +" → "Web Service"
3. Connect your GitHub repository
4. Configure the service:
   - **Name**: `ai-learning-backend`
   - **Environment**: `Node`
   - **Build Command**: `npm install`
   - **Start Command**: `npm start`
   - **Plan**: Free (or paid for better performance)

5. Add Environment Variables:
   ```
   NODE_ENV=production
   JWT_SECRET=your-super-secret-jwt-key-here
   GROQ_API_KEY=your-groq-api-key-here
   FRONTEND_URL=https://your-app.netlify.app
   ```

6. Add a PostgreSQL database (free tier):
   - Go to "New +" → "PostgreSQL"
   - Name: `ai-learning-db`
   - Plan: Free
   - Copy the connection string to `MONGODB_URI` environment variable

**Note**: Since we're using MongoDB but Render's free database is PostgreSQL, you have two options:
- Option A: Use MongoDB Atlas (recommended) - create a free cluster and use the connection string
- Option B: Modify the app to use PostgreSQL with Prisma or similar

### Step 3: MongoDB Atlas Setup (Recommended)

1. Go to [MongoDB Atlas](https://www.mongodb.com/atlas)
2. Create a free cluster
3. Create a database user
4. Whitelist all IP addresses (0.0.0.0/0) for production
5. Get the connection string and add it as `MONGODB_URI` in Render

## Frontend Deployment (Netlify)

### Step 1: Prepare Environment Variables

Create `client/.env.production`:
```
REACT_APP_API_URL=https://your-render-app.onrender.com/api
```

### Step 2: Deploy to Netlify

1. Go to [Netlify Dashboard](https://app.netlify.com/)
2. Click "Add new site" → "Import an existing project"
3. Connect your GitHub repository
4. Configure build settings:
   - **Base directory**: `client`
   - **Build command**: `npm run build`
   - **Publish directory**: `client/build`

5. Add Environment Variables in Netlify:
   - Go to Site settings → Environment variables
   - Add: `REACT_APP_API_URL=https://your-render-app.onrender.com/api`

6. Deploy the site

### Step 3: Update CORS Configuration

After both deployments:

1. Update the `FRONTEND_URL` environment variable in Render with your actual Netlify URL
2. Redeploy the Render service

## Post-Deployment Steps

1. Test the application thoroughly
2. Set up custom domains (optional)
3. Configure SSL certificates (usually automatic)
4. Set up monitoring and logging

## Troubleshooting

### Common Issues:

1. **CORS Errors**: Make sure `FRONTEND_URL` in Render matches your Netlify URL exactly
2. **Database Connection**: Verify MongoDB Atlas connection string and IP whitelist
3. **API Calls Failing**: Check that `REACT_APP_API_URL` points to your Render backend
4. **Build Failures**: Check build logs in both Render and Netlify

### Environment URLs:

- **Backend**: `https://your-app-name.onrender.com`
- **Frontend**: `https://your-app-name.netlify.app`

## Cost Optimization

Both services offer free tiers:
- **Render Free**: 750 hours/month, sleeps after 15 minutes of inactivity
- **Netlify Free**: 100GB bandwidth, 300 build minutes/month

For production use, consider upgrading to paid plans for better performance and uptime.

## Security Considerations

1. Use strong JWT secrets
2. Keep API keys secure
3. Enable HTTPS (automatic on both platforms)
4. Regularly update dependencies
5. Monitor for security vulnerabilities

## Backup Strategy

1. Regular database backups (MongoDB Atlas provides automatic backups)
2. Keep your code in version control
3. Document your environment variables securely